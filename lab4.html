<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2018a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Untitled</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.2339992523193px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { margin-left: 3px; margin-top: 4px; margin-bottom: 4px; margin-right: 3px;  }
.S2 { min-height: 18px; white-space: nowrap; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { min-height: 0px; white-space: pre; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S4 { color: rgb(34, 139, 34); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S5 { color: rgb(160, 32, 240); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.CodeBlock {margin: 10px 0 10px 0; background-color: #F7F7F7;}
.CodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S4">%1</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">h5disp(</span><span class="S5">'gammaray_lab4.h5'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">mydata = h5read(</span><span class="S5">'gammaray_lab4.h5'</span><span class="S0">,</span><span class="S5">'/data'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">X = linspace(1,25,2560001);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">pd = normpdf(mydata(27000:81000,4),6,sqrt(6));</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">sig = find(pd);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">histogram(mydata(:,4))</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S4">%histogram(pd)</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S4">%stairs(mydata(27000:81000,1),mydata(27000:81000,4))</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">stairs(1:max(size(mydata(27000:81000,1))),mydata(27000:81000,4))</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">A = find((pd&lt;2.86*10^-7).*pd);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">fivesigma = 27000+A(1)</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S4">%for my model I choose a data size of 54k points similar to the background</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S4">%interval choosen</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">modelc = makedist(</span><span class="S5">'Exponential'</span><span class="S0">,</span><span class="S5">'mu'</span><span class="S0">,0.0435);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">datac = normrnd(7.1,3,[1 54001]);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">modeldist = pdf(modelc,datac);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">plot(linspace(1,54000,54001),mydata(27000:81000,4))</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S4">%2</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">h5disp(</span><span class="S5">'images.h5'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">mydata2 = h5read(</span><span class="S5">'images.h5'</span><span class="S0">,</span><span class="S5">'/imagestack'</span><span class="S0">); </span><span class="S4">%mydata1 = h5read('image.h5','/image1');</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">plot(linspace(1,200,40000),mydata2(1,:))</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">A = mean(mydata2);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">back = (A(1,:)&lt;1);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">bdata = back.*mydata2(1,:);</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">plot(linspace(1,40000,40000),bdata(1,:))</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">pt = (find((normpdf(mydata2(1,:),0,1)&lt;2.86*10^-7).*(1:40000)));</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">stairs(linspace(1,40000,max(size(pt))),mydata2(1,round(pt)))</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">faintest = find(min(mydata2(1,pt))==mydata2(1,pt));</span></span></div></div><div class = 'inlineWrapper'><div class = "S2 lineNode"><span class = "S3"><span class="S0">pixel = mydata2(:,pt(faintest))</span></span></div></div></div></div></div><br><!-- <br>##### SOURCE BEGIN #####<br>%1<br>h5disp('gammaray_lab4.h5');<br>mydata = h5read('gammaray_lab4.h5','/data');<br>X = linspace(1,25,2560001);<br>pd = normpdf(mydata(27000:81000,4),6,sqrt(6));<br>sig = find(pd);<br>histogram(mydata(:,4))<br>%histogram(pd)<br>%stairs(mydata(27000:81000,1),mydata(27000:81000,4))<br>stairs(1:max(size(mydata(27000:81000,1))),mydata(27000:81000,4))<br>A = find((pd<2.86*10^-7).*pd);<br>fivesigma = 27000+A(1)<br>%for my model I choose a data size of 54k points similar to the background<br>%interval choosen<br>modelc = makedist('Exponential','mu',0.0435);<br>datac = normrnd(7.1,3,[1 54001]);<br>modeldist = pdf(modelc,datac);<br>plot(linspace(1,54000,54001),mydata(27000:81000,4))<br><br><br>%2<br>h5disp('images.h5');<br>mydata2 = h5read('images.h5','/imagestack'); %mydata1 = h5read('image.h5','/image1');<br>plot(linspace(1,200,40000),mydata2(1,:))<br>A = mean(mydata2);<br>back = (A(1,:)<1);<br>bdata = back.*mydata2(1,:);<br>plot(linspace(1,40000,40000),bdata(1,:))<br>pt = (find((normpdf(mydata2(1,:),0,1)<2.86*10^-7).*(1:40000)));<br>stairs(linspace(1,40000,max(size(pt))),mydata2(1,round(pt)))<br>faintest = find(min(mydata2(1,pt))==mydata2(1,pt));<br>pixel = mydata2(:,pt(faintest))<br>##### SOURCE END #####<br>--></body></html>